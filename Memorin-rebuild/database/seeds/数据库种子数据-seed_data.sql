-- ====================================================================
-- Memorin æ™ºèƒ½çŸ¥è¯†å¤ä¹ ç³»ç»Ÿ - ç§å­æ•°æ®è„šæœ¬
-- ç‰ˆæœ¬: v2.0 - æ¨¡å—åŒ–è®¾è®¡
-- ç”¨é€”: æä¾›ç³»ç»Ÿåˆå§‹åŒ–æ•°æ®å’Œæ¼”ç¤ºæ•°æ®
-- åˆ›å»ºæ—¶é—´: 2025-01-08
-- ====================================================================

USE memorin_db;

-- ç¦ç”¨å¤–é”®æ£€æŸ¥ï¼ˆæ’å…¥æ•°æ®æ—¶ï¼‰
SET FOREIGN_KEY_CHECKS = 0;

-- ====================================================================
-- 1. ç”¨æˆ·è®¤è¯æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 1.1 åˆ›å»ºç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·
INSERT INTO users (id, username, email, password_hash, status) VALUES 
(1, 'admin', 'admin@memorin.com', '$2b$12$dummyHashForAdmin123456789', 'active'),
(2, 'demo_teacher', 'teacher@demo.com', '$2b$12$dummyHashForTeacher123456', 'active'),
(3, 'demo_student1', 'student1@demo.com', '$2b$12$dummyHashForStudent123456', 'active'),
(4, 'demo_student2', 'student2@demo.com', '$2b$12$dummyHashForStudent223456', 'active'),
(5, 'system', 'system@memorin.com', '$2b$12$dummyHashForSystem1234567', 'active');

-- 1.2 ç”¨æˆ·æ‰©å±•ä¿¡æ¯
INSERT INTO user_profiles (user_id, nickname, avatar_url, bio, timezone, language) VALUES 
(1, 'ç³»ç»Ÿç®¡ç†å‘˜', '/avatars/admin.jpg', 'Memorinç³»ç»Ÿç®¡ç†å‘˜', 'Asia/Shanghai', 'zh-CN'),
(2, 'æ¼”ç¤ºæ•™å¸ˆ', '/avatars/teacher.jpg', 'è®¡ç®—æœºç§‘å­¦ä¸“ä¸šæ•™å¸ˆï¼Œä¸“æ³¨è½¯ä»¶å·¥ç¨‹æ•™å­¦', 'Asia/Shanghai', 'zh-CN'),
(3, 'å­¦ç”Ÿç”²', '/avatars/student1.jpg', 'è®¡ç®—æœºç§‘å­¦ä¸“ä¸šæœ¬ç§‘ç”Ÿ', 'Asia/Shanghai', 'zh-CN'),
(4, 'å­¦ç”Ÿä¹™', '/avatars/student2.jpg', 'è½¯ä»¶å·¥ç¨‹ä¸“ä¸šç ”ç©¶ç”Ÿ', 'Asia/Shanghai', 'zh-CN'),
(5, 'ç³»ç»Ÿç”¨æˆ·', '/avatars/system.jpg', 'ç³»ç»Ÿå†…ç½®ç”¨æˆ·ï¼Œç”¨äºå®˜æ–¹å†…å®¹', 'Asia/Shanghai', 'zh-CN');

-- 1.3 ç”¨æˆ·è®¾ç½®
INSERT INTO user_settings (user_id, theme, daily_review_goal, difficulty_preference) VALUES 
(1, 'auto', 50, 4),
(2, 'light', 30, 3),
(3, 'dark', 20, 2),
(4, 'auto', 25, 3),
(5, 'light', 0, 3);

-- ====================================================================
-- 2. çŸ¥è¯†åº“ç®¡ç†æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 2.1 åˆ›å»ºå®˜æ–¹çŸ¥è¯†åº“
INSERT INTO knowledge_bases (id, owner_id, name, visibility, is_official, status) VALUES 
(1, 5, 'è½¯ä»¶å·¥ç¨‹åŸºç¡€', 'public', TRUE, 'active'),
(2, 5, 'æ•°æ®ç»“æ„ä¸ç®—æ³•', 'public', TRUE, 'active'),
(3, 5, 'è®¡ç®—æœºç½‘ç»œ', 'public', TRUE, 'active'),
(4, 2, 'é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡', 'public', FALSE, 'active'),
(5, 2, 'è½¯ä»¶æµ‹è¯•å®è·µ', 'shared', FALSE, 'active');

-- 2.2 çŸ¥è¯†åº“å…ƒæ•°æ®
INSERT INTO knowledge_base_metadata (knowledge_base_id, description, icon, color, category, tags, difficulty_level, estimated_time_hours, learning_objectives, license) VALUES 
(1, 'æ¶µç›–è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€å¼€å‘æ–¹æ³•ã€é¡¹ç›®ç®¡ç†ç­‰æ ¸å¿ƒå†…å®¹', 'ğŸ› ï¸', '#2196F3', 'è®¡ç®—æœºç§‘å­¦', '["è½¯ä»¶å·¥ç¨‹", "å¼€å‘æ–¹æ³•", "é¡¹ç›®ç®¡ç†"]', 3.2, 40, '["ç†è§£è½¯ä»¶å·¥ç¨‹åŸºæœ¬æ¦‚å¿µ", "æŒæ¡è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸ", "å­¦ä¼šé¡¹ç›®ç®¡ç†åŸºç¡€"]', 'CC BY-SA 4.0'),
(2, 'æ•°æ®ç»“æ„çš„åŸºæœ¬æ¦‚å¿µå’Œå¸¸ç”¨ç®—æ³•çš„å®ç°ä¸åˆ†æ', 'ğŸ”¢', '#4CAF50', 'è®¡ç®—æœºç§‘å­¦', '["æ•°æ®ç»“æ„", "ç®—æ³•", "ç¼–ç¨‹"]', 3.8, 60, '["æŒæ¡åŸºæœ¬æ•°æ®ç»“æ„", "ç†è§£ç®—æ³•å¤æ‚åº¦", "èƒ½å¤Ÿå®ç°å¸¸ç”¨ç®—æ³•"]', 'CC BY-SA 4.0'),
(3, 'è®¡ç®—æœºç½‘ç»œçš„åŸºæœ¬åŸç†ã€åè®®å’Œç½‘ç»œç¼–ç¨‹', 'ğŸŒ', '#FF9800', 'è®¡ç®—æœºç§‘å­¦', '["ç½‘ç»œ", "åè®®", "é€šä¿¡"]', 3.5, 50, '["ç†è§£ç½‘ç»œåŸºæœ¬åŸç†", "æŒæ¡TCP/IPåè®®", "å­¦ä¼šç½‘ç»œç¼–ç¨‹"]', 'CC BY-SA 4.0'),
(4, 'é¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³å’ŒJavaè¯­è¨€å®è·µ', 'â˜•', '#795548', 'ç¼–ç¨‹è¯­è¨€', '["é¢å‘å¯¹è±¡", "Java", "ç¼–ç¨‹"]', 3.0, 45, '["æŒæ¡é¢å‘å¯¹è±¡æ€æƒ³", "ç†Ÿç»ƒä½¿ç”¨Java", "èƒ½å¤Ÿè®¾è®¡é¢å‘å¯¹è±¡ç¨‹åº"]', 'CC BY-NC 4.0'),
(5, 'è½¯ä»¶æµ‹è¯•çš„ç†è®ºã€æ–¹æ³•å’Œå·¥å…·ä½¿ç”¨', 'ğŸ§ª', '#9C27B0', 'è½¯ä»¶è´¨é‡', '["æµ‹è¯•", "è´¨é‡ä¿è¯", "å·¥å…·"]', 3.3, 35, '["ç†è§£æµ‹è¯•ç†è®º", "æŒæ¡æµ‹è¯•æ–¹æ³•", "ç†Ÿç»ƒä½¿ç”¨æµ‹è¯•å·¥å…·"]', 'CC BY-NC 4.0');

-- 2.3 åˆ›å»ºçŸ¥è¯†åŒº
INSERT INTO knowledge_areas (id, creator_id, name, parent_area_id, level, sort_order) VALUES 
(1, 5, 'è½¯ä»¶å·¥ç¨‹æ¦‚è®º', NULL, 1, 1),
(2, 5, 'éœ€æ±‚åˆ†æ', 1, 2, 1),
(3, 5, 'ç³»ç»Ÿè®¾è®¡', 1, 2, 2),
(4, 5, 'ç¼–ç å®ç°', 1, 2, 3),
(5, 5, 'è½¯ä»¶æµ‹è¯•', 1, 2, 4),
(6, 5, 'é¡¹ç›®ç®¡ç†', 1, 2, 5),
(7, 5, 'æ•°æ®ç»“æ„åŸºç¡€', NULL, 1, 2),
(8, 5, 'çº¿æ€§ç»“æ„', 7, 2, 1),
(9, 5, 'æ ‘å½¢ç»“æ„', 7, 2, 2),
(10, 5, 'å›¾å½¢ç»“æ„', 7, 2, 3);

-- 2.4 çŸ¥è¯†åŒºå…ƒæ•°æ®
INSERT INTO knowledge_area_metadata (knowledge_area_id, description, color, icon, category, tags) VALUES 
(1, 'è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬æ¦‚å¿µå’ŒåŸç†', '#2196F3', 'ğŸ“š', 'ç†è®ºåŸºç¡€', '["æ¦‚å¿µ", "åŸç†"]'),
(2, 'è½¯ä»¶éœ€æ±‚çš„åˆ†æå’Œç®¡ç†', '#4CAF50', 'ğŸ“', 'éœ€æ±‚å·¥ç¨‹', '["éœ€æ±‚åˆ†æ", "éœ€æ±‚ç®¡ç†"]'),
(3, 'è½¯ä»¶ç³»ç»Ÿçš„æ¶æ„å’Œè¯¦ç»†è®¾è®¡', '#FF9800', 'ğŸ—ï¸', 'è®¾è®¡æ–¹æ³•', '["æ¶æ„è®¾è®¡", "è¯¦ç»†è®¾è®¡"]'),
(4, 'è½¯ä»¶çš„ç¼–ç å’Œå®ç°æŠ€æœ¯', '#9C27B0', 'ğŸ’»', 'å®ç°æŠ€æœ¯', '["ç¼–ç ", "å®ç°"]'),
(5, 'è½¯ä»¶æµ‹è¯•çš„æ–¹æ³•å’ŒæŠ€æœ¯', '#F44336', 'ğŸ§ª', 'è´¨é‡ä¿è¯', '["æµ‹è¯•æ–¹æ³•", "è´¨é‡æ§åˆ¶"]'),
(6, 'è½¯ä»¶é¡¹ç›®çš„ç®¡ç†å’Œæ§åˆ¶', '#607D8B', 'ğŸ“Š', 'é¡¹ç›®ç®¡ç†', '["é¡¹ç›®æ§åˆ¶", "å›¢é˜Ÿç®¡ç†"]'),
(7, 'æ•°æ®ç»“æ„çš„åŸºæœ¬æ¦‚å¿µ', '#3F51B5', 'ğŸ”¢', 'åŸºç¡€ç†è®º', '["æ•°æ®ç»“æ„", "æŠ½è±¡æ•°æ®ç±»å‹"]'),
(8, 'æ•°ç»„ã€é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—ç­‰çº¿æ€§ç»“æ„', '#009688', 'ğŸ“', 'çº¿æ€§ç»“æ„', '["æ•°ç»„", "é“¾è¡¨", "æ ˆ", "é˜Ÿåˆ—"]'),
(9, 'äºŒå‰æ ‘ã€å¹³è¡¡æ ‘ã€å †ç­‰æ ‘å½¢ç»“æ„', '#8BC34A', 'ğŸŒ³', 'æ ‘å½¢ç»“æ„', '["äºŒå‰æ ‘", "å¹³è¡¡æ ‘", "å †"]'),
(10, 'å›¾çš„è¡¨ç¤ºã€éå†å’Œåº”ç”¨', '#CDDC39', 'ğŸ•¸ï¸', 'å›¾å½¢ç»“æ„', '["å›¾", "éå†", "æœ€çŸ­è·¯å¾„"]');

-- ====================================================================
-- 3. çŸ¥è¯†ç‚¹å†…å®¹æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 3.1 åˆ›å»ºçŸ¥è¯†ç‚¹å†…å®¹ï¼ˆå¡«ç©ºé¢˜ï¼‰
INSERT INTO knowledge_point_contents (id, content_hash, type, question, answer, explanation, created_by, is_public) VALUES 
(1, SHA2('ä»€ä¹ˆæ˜¯è½¯ä»¶å·¥ç¨‹ï¼Ÿè½¯ä»¶å·¥ç¨‹æ˜¯ä¸€é—¨è¿ç”¨è®¡ç®—æœºç§‘å­¦ç†è®ºå’ŒæŠ€æœ¯ä»¥åŠå·¥ç¨‹ç®¡ç†åŸåˆ™å’Œæ–¹æ³•ï¼ŒæŒ‰ç…§å·¥ç¨‹åŒ–çš„åŸåˆ™å’Œæ–¹æ³•æ¥æŒ‡å¯¼è½¯ä»¶å¼€å‘å’Œç»´æŠ¤çš„å­¦ç§‘ã€‚', 256), 'fill', 'ä»€ä¹ˆæ˜¯è½¯ä»¶å·¥ç¨‹ï¼Ÿ', 'è½¯ä»¶å·¥ç¨‹æ˜¯ä¸€é—¨è¿ç”¨è®¡ç®—æœºç§‘å­¦ç†è®ºå’ŒæŠ€æœ¯ä»¥åŠå·¥ç¨‹ç®¡ç†åŸåˆ™å’Œæ–¹æ³•ï¼ŒæŒ‰ç…§å·¥ç¨‹åŒ–çš„åŸåˆ™å’Œæ–¹æ³•æ¥æŒ‡å¯¼è½¯ä»¶å¼€å‘å’Œç»´æŠ¤çš„å­¦ç§‘ã€‚', 'è½¯ä»¶å·¥ç¨‹å¼ºè°ƒç³»ç»Ÿæ€§ã€è§„èŒƒæ€§å’Œå¯åº¦é‡æ€§ï¼Œæ˜¯è§£å†³è½¯ä»¶å±æœºçš„é‡è¦é€”å¾„ã€‚', 5, TRUE),

(2, SHA2('è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬å“ªäº›é˜¶æ®µï¼Ÿè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬éœ€æ±‚åˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç¼–ç å®ç°ã€è½¯ä»¶æµ‹è¯•ã€éƒ¨ç½²è¿ç»´ç­‰é˜¶æ®µã€‚', 256), 'fill', 'è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬å“ªäº›é˜¶æ®µï¼Ÿ', 'è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬éœ€æ±‚åˆ†æã€ç³»ç»Ÿè®¾è®¡ã€ç¼–ç å®ç°ã€è½¯ä»¶æµ‹è¯•ã€éƒ¨ç½²è¿ç»´ç­‰é˜¶æ®µã€‚', 'è¿™äº›é˜¶æ®µå¯ä»¥é‡‡ç”¨ä¸åŒçš„å¼€å‘æ¨¡å‹æ¥ç»„ç»‡ï¼Œå¦‚ç€‘å¸ƒæ¨¡å‹ã€è¿­ä»£æ¨¡å‹ã€æ•æ·æ¨¡å‹ç­‰ã€‚', 5, TRUE),

(3, SHA2('ä»€ä¹ˆæ˜¯éœ€æ±‚åˆ†æï¼Ÿéœ€æ±‚åˆ†ææ˜¯ç¡®å®šç³»ç»Ÿå¿…é¡»å…·å¤‡çš„åŠŸèƒ½å’Œæ€§èƒ½çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬åŠŸèƒ½éœ€æ±‚å’ŒéåŠŸèƒ½éœ€æ±‚çš„è¯†åˆ«ã€åˆ†æå’Œæ–‡æ¡£åŒ–ã€‚', 256), 'fill', 'ä»€ä¹ˆæ˜¯éœ€æ±‚åˆ†æï¼Ÿ', 'éœ€æ±‚åˆ†ææ˜¯ç¡®å®šç³»ç»Ÿå¿…é¡»å…·å¤‡çš„åŠŸèƒ½å’Œæ€§èƒ½çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬åŠŸèƒ½éœ€æ±‚å’ŒéåŠŸèƒ½éœ€æ±‚çš„è¯†åˆ«ã€åˆ†æå’Œæ–‡æ¡£åŒ–ã€‚', 'éœ€æ±‚åˆ†ææ˜¯è½¯ä»¶å¼€å‘çš„åŸºç¡€ï¼Œç›´æ¥å½±å“åç»­è®¾è®¡å’Œå®ç°çš„è´¨é‡ã€‚', 5, TRUE),

(4, SHA2('æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿæ•°ç»„æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…·æœ‰éšæœºè®¿é—®ã€å†…å­˜è¿ç»­ã€ç±»å‹ç›¸åŒç­‰ç‰¹ç‚¹ã€‚', 256), 'fill', 'æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ', 'æ•°ç»„æ˜¯ä¸€ç§çº¿æ€§æ•°æ®ç»“æ„ï¼Œå…·æœ‰éšæœºè®¿é—®ã€å†…å­˜è¿ç»­ã€ç±»å‹ç›¸åŒç­‰ç‰¹ç‚¹ã€‚', 'æ•°ç»„æ”¯æŒO(1)æ—¶é—´å¤æ‚åº¦çš„éšæœºè®¿é—®ï¼Œä½†æ’å…¥å’Œåˆ é™¤æ“ä½œå¯èƒ½éœ€è¦O(n)æ—¶é—´ã€‚', 5, TRUE),

(5, SHA2('ä»€ä¹ˆæ˜¯æ ˆï¼Ÿæ ˆæ˜¯ä¸€ç§åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œåªèƒ½åœ¨æ ˆé¡¶è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚', 256), 'fill', 'ä»€ä¹ˆæ˜¯æ ˆï¼Ÿ', 'æ ˆæ˜¯ä¸€ç§åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰çš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œåªèƒ½åœ¨æ ˆé¡¶è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚', 'æ ˆçš„ä¸»è¦æ“ä½œåŒ…æ‹¬pushï¼ˆå…¥æ ˆï¼‰ã€popï¼ˆå‡ºæ ˆï¼‰ã€topï¼ˆæŸ¥çœ‹æ ˆé¡¶å…ƒç´ ï¼‰ç­‰ã€‚', 5, TRUE);

-- 3.2 åˆ›å»ºé€‰æ‹©é¢˜å†…å®¹
INSERT INTO knowledge_point_contents (id, content_hash, type, question, answer, explanation, created_by, is_public) VALUES 
(6, SHA2('ä¸‹åˆ—å“ªä¸ªä¸æ˜¯è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬åŸåˆ™ï¼ŸA', 256), 'choice', 'ä¸‹åˆ—å“ªä¸ªä¸æ˜¯è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬åŸåˆ™ï¼Ÿ', 'A', 'è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬åŸåˆ™åŒ…æ‹¬åˆ†é˜¶æ®µå¼€å‘ã€ä¸¥æ ¼ç®¡ç†ã€æ˜ç¡®è´£ä»»ã€äº§å“æ ‡å‡†åŒ–ç­‰ï¼Œä½†ä¸åŒ…æ‹¬é™ä½æˆæœ¬ä¼˜å…ˆã€‚', 5, TRUE),

(7, SHA2('ç€‘å¸ƒæ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼ŸB', 256), 'choice', 'ç€‘å¸ƒæ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ', 'B', 'ç€‘å¸ƒæ¨¡å‹æ˜¯ä¸€ç§çº¿æ€§é¡ºåºçš„è½¯ä»¶å¼€å‘æ¨¡å‹ï¼Œå„é˜¶æ®µä¾æ¬¡è¿›è¡Œï¼Œå‰ä¸€é˜¶æ®µå®Œæˆåæ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚', 5, TRUE),

(8, SHA2('äºŒå‰æ ‘çš„éå†æ–¹å¼æœ‰å‡ ç§ï¼ŸC', 256), 'choice', 'äºŒå‰æ ‘çš„éå†æ–¹å¼æœ‰å‡ ç§ï¼Ÿ', 'C', 'äºŒå‰æ ‘æœ‰ä¸‰ç§åŸºæœ¬çš„éå†æ–¹å¼ï¼šå‰åºéå†ã€ä¸­åºéå†ã€ååºéå†ã€‚', 5, TRUE);

-- 3.3 çŸ¥è¯†ç‚¹å…ƒæ•°æ®
INSERT INTO knowledge_point_metadata (content_id, difficulty, estimated_time, score, tags, cognitive_level, learning_objective) VALUES 
(1, 2, 90, 2.0, '["è½¯ä»¶å·¥ç¨‹", "åŸºç¡€æ¦‚å¿µ"]', 'understand', 'ç†è§£è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬å®šä¹‰å’Œç›®æ ‡'),
(2, 3, 120, 3.0, '["ç”Ÿå‘½å‘¨æœŸ", "å¼€å‘è¿‡ç¨‹"]', 'remember', 'æŒæ¡è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸçš„å„ä¸ªé˜¶æ®µ'),
(3, 3, 100, 2.5, '["éœ€æ±‚åˆ†æ", "ç³»ç»Ÿåˆ†æ"]', 'understand', 'ç†è§£éœ€æ±‚åˆ†æçš„é‡è¦æ€§å’ŒåŸºæœ¬æ–¹æ³•'),
(4, 2, 80, 2.0, '["æ•°ç»„", "æ•°æ®ç»“æ„"]', 'understand', 'æŒæ¡æ•°ç»„çš„åŸºæœ¬ç‰¹ç‚¹å’Œä½¿ç”¨åœºæ™¯'),
(5, 2, 75, 2.0, '["æ ˆ", "LIFO"]', 'remember', 'ç†è§£æ ˆçš„åŸºæœ¬æ¦‚å¿µå’Œæ“ä½œ'),
(6, 3, 90, 3.0, '["è½¯ä»¶å·¥ç¨‹", "åŸåˆ™"]', 'analyze', 'åˆ†æè½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬åŸåˆ™'),
(7, 3, 85, 2.5, '["ç€‘å¸ƒæ¨¡å‹", "å¼€å‘æ¨¡å‹"]', 'understand', 'ç†è§£ç€‘å¸ƒæ¨¡å‹çš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯'),
(8, 2, 70, 2.0, '["äºŒå‰æ ‘", "éå†"]', 'remember', 'æŒæ¡äºŒå‰æ ‘çš„åŸºæœ¬éå†æ–¹æ³•');

-- 3.4 é€‰æ‹©é¢˜é€‰é¡¹
INSERT INTO knowledge_point_choice_options (content_id, choice_type, option_key, option_text, is_correct, sort_order) VALUES 
(6, 'single', 'A', 'é™ä½æˆæœ¬ä¼˜å…ˆ', TRUE, 1),
(6, 'single', 'B', 'åˆ†é˜¶æ®µå¼€å‘', FALSE, 2),
(6, 'single', 'C', 'ä¸¥æ ¼ç®¡ç†', FALSE, 3),
(6, 'single', 'D', 'äº§å“æ ‡å‡†åŒ–', FALSE, 4),

(7, 'single', 'A', 'å¯ä»¥éšæ—¶å›åˆ°å‰é¢çš„é˜¶æ®µ', FALSE, 1),
(7, 'single', 'B', 'å„é˜¶æ®µä¾æ¬¡è¿›è¡Œï¼Œä¸å¯é€†è½¬', TRUE, 2),
(7, 'single', 'C', 'æ”¯æŒå¹¶è¡Œå¼€å‘', FALSE, 3),
(7, 'single', 'D', 'é€‚åˆéœ€æ±‚å˜åŒ–é¢‘ç¹çš„é¡¹ç›®', FALSE, 4),

(8, 'single', 'A', '1ç§', FALSE, 1),
(8, 'single', 'B', '2ç§', FALSE, 2),
(8, 'single', 'C', '3ç§', TRUE, 3),
(8, 'single', 'D', '4ç§', FALSE, 4);

-- ====================================================================
-- 4. å…³è”å…³ç³»æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 4.1 çŸ¥è¯†åº“-å†…å®¹å…³è”
INSERT INTO knowledge_base_content_relations (knowledge_base_id, content_id, category, chapter, sort_order, added_by) VALUES 
(1, 1, 'åŸºç¡€æ¦‚å¿µ', 'ç¬¬1ç«  è½¯ä»¶å·¥ç¨‹æ¦‚è¿°', 1, 5),
(1, 2, 'å¼€å‘è¿‡ç¨‹', 'ç¬¬2ç«  è½¯ä»¶å¼€å‘è¿‡ç¨‹', 2, 5),
(1, 3, 'éœ€æ±‚å·¥ç¨‹', 'ç¬¬3ç«  éœ€æ±‚åˆ†æ', 3, 5),
(1, 6, 'åŸºç¡€æ¦‚å¿µ', 'ç¬¬1ç«  è½¯ä»¶å·¥ç¨‹æ¦‚è¿°', 4, 5),
(1, 7, 'å¼€å‘æ¨¡å‹', 'ç¬¬2ç«  è½¯ä»¶å¼€å‘è¿‡ç¨‹', 5, 5),

(2, 4, 'çº¿æ€§ç»“æ„', 'ç¬¬1ç«  åŸºæœ¬æ•°æ®ç»“æ„', 1, 5),
(2, 5, 'çº¿æ€§ç»“æ„', 'ç¬¬1ç«  åŸºæœ¬æ•°æ®ç»“æ„', 2, 5),
(2, 8, 'æ ‘å½¢ç»“æ„', 'ç¬¬2ç«  æ ‘å’Œå›¾', 3, 5);

-- 4.2 çŸ¥è¯†åŒº-å†…å®¹å…³è”
INSERT INTO knowledge_area_content_relations (knowledge_area_id, content_id, relevance_score, is_primary, relationship_type, added_by) VALUES 
(1, 1, 1.0, TRUE, 'contains', 5),
(1, 6, 0.9, TRUE, 'contains', 5),
(2, 3, 1.0, TRUE, 'contains', 5),
(3, 7, 0.8, FALSE, 'relates', 5),
(7, 4, 1.0, TRUE, 'contains', 5),
(8, 4, 1.0, TRUE, 'contains', 5),
(8, 5, 1.0, TRUE, 'contains', 5),
(9, 8, 1.0, TRUE, 'contains', 5);

-- ====================================================================
-- 5. ç”¨æˆ·å­¦ä¹ çŠ¶æ€æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 5.1 ç”¨æˆ·çŸ¥è¯†ç‚¹çŠ¶æ€ï¼ˆæ¼”ç¤ºç”¨æˆ·çš„å­¦ä¹ æ•°æ®ï¼‰
INSERT INTO user_knowledge_point_states (user_id, content_id, mastery_level, review_count, correct_count, consecutive_correct, first_learned_at, last_reviewed_at, next_review_at, is_bookmarked) VALUES 
(3, 1, 4, 5, 4, 2, '2024-12-01 10:00:00', '2024-12-15 14:30:00', '2025-01-10 09:00:00', TRUE),
(3, 2, 3, 3, 2, 1, '2024-12-02 11:00:00', '2024-12-10 15:00:00', '2025-01-08 10:00:00', FALSE),
(3, 4, 5, 8, 7, 5, '2024-11-20 09:30:00', '2024-12-20 16:00:00', '2025-01-25 11:00:00', TRUE),
(3, 5, 2, 2, 1, 0, '2024-12-05 13:00:00', '2024-12-06 14:00:00', '2025-01-09 12:00:00', FALSE),

(4, 1, 5, 6, 6, 6, '2024-11-15 08:00:00', '2024-12-18 10:30:00', '2025-02-01 09:00:00', FALSE),
(4, 2, 4, 4, 3, 2, '2024-11-16 09:00:00', '2024-12-12 11:00:00', '2025-01-15 10:00:00', TRUE),
(4, 3, 3, 2, 1, 1, '2024-12-01 10:00:00', '2024-12-03 15:00:00', '2025-01-12 14:00:00', FALSE),
(4, 6, 4, 3, 3, 3, '2024-12-04 11:00:00', '2024-12-16 16:00:00', '2025-01-20 12:00:00', TRUE);

-- 5.2 SM-2ç®—æ³•æ•°æ®
INSERT INTO user_knowledge_point_sm2_data (user_id, content_id, easiness_factor, repetition_number, inter_repetition_interval, last_interval) VALUES 
(3, 1, 2.6, 3, 6, 3),
(3, 2, 2.4, 2, 3, 1),
(3, 4, 2.8, 5, 15, 6),
(3, 5, 2.3, 1, 1, 1),

(4, 1, 2.9, 6, 25, 15),
(4, 2, 2.7, 3, 8, 4),
(4, 3, 2.5, 2, 3, 1),
(4, 6, 2.6, 3, 6, 3);

-- 5.3 ç”¨æˆ·å­¦ä¹ è¡¨ç°æ•°æ®
INSERT INTO user_knowledge_point_performance (user_id, content_id, personal_difficulty, personal_notes, avg_response_time, fastest_time, confidence_level) VALUES 
(3, 1, 2, 'è½¯ä»¶å·¥ç¨‹çš„å®šä¹‰éœ€è¦é‡ç‚¹è®°å¿†', 75, 45, 4),
(3, 2, 3, 'ç”Ÿå‘½å‘¨æœŸå„é˜¶æ®µå®¹æ˜“æ··æ·†', 95, 60, 3),
(3, 4, 1, 'æ•°ç»„å¾ˆç®€å•ï¼ŒåŸºç¡€æ¦‚å¿µ', 55, 30, 5),
(3, 5, 4, 'æ ˆçš„æ¦‚å¿µè¿˜éœ€è¦åŠ å¼ºç†è§£', 120, 80, 2),

(4, 1, 1, 'åŸºç¡€æ¦‚å¿µï¼Œå·²ç»æŒæ¡', 50, 35, 5),
(4, 2, 2, 'æ¯”è¾ƒå®¹æ˜“ç†è§£', 65, 45, 4),
(4, 3, 3, 'éœ€æ±‚åˆ†æåœ¨å®è·µä¸­åº”ç”¨è¾ƒå¤š', 85, 60, 3),
(4, 6, 2, 'é€‰æ‹©é¢˜éœ€è¦ä»”ç»†åˆ†æé€‰é¡¹', 70, 50, 4);

-- ====================================================================
-- 6. é¢˜ç›®åˆ—è¡¨æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 6.1 åˆ›å»ºè‡ªå®šä¹‰é¢˜ç›®åˆ—è¡¨
INSERT INTO custom_question_lists (id, user_id, name, type, status, total_count, is_public) VALUES 
(1, 3, 'è½¯ä»¶å·¥ç¨‹åŸºç¡€å¤ä¹ ', 'review', 'active', 4, FALSE),
(2, 4, 'æ•°æ®ç»“æ„å…¥é—¨ç»ƒä¹ ', 'practice', 'active', 3, TRUE),
(3, 2, 'æœŸæœ«è€ƒè¯•æ¨¡æ‹Ÿå·', 'exam', 'active', 6, TRUE);

-- 6.2 é¢˜ç›®åˆ—è¡¨å…ƒæ•°æ®
INSERT INTO question_list_metadata (question_list_id, description, estimated_time, difficulty_level, category, learning_objectives) VALUES 
(1, 'é’ˆå¯¹è½¯ä»¶å·¥ç¨‹åŸºç¡€æ¦‚å¿µçš„å¤ä¹ é¢˜ç›®é›†åˆ', 25, 2.8, 'è½¯ä»¶å·¥ç¨‹', '["å·©å›ºåŸºç¡€æ¦‚å¿µ", "å‡†å¤‡è€ƒè¯•"]'),
(2, 'æ•°æ®ç»“æ„çš„å…¥é—¨çº§ç»ƒä¹ é¢˜ç›®', 20, 2.3, 'æ•°æ®ç»“æ„', '["ç†è§£åŸºæœ¬æ¦‚å¿µ", "åŸ¹å…»ç¼–ç¨‹æ€ç»´"]'),
(3, 'æ¨¡æ‹ŸæœŸæœ«è€ƒè¯•çš„ç»¼åˆé¢˜ç›®', 90, 3.2, 'ç»¼åˆæµ‹è¯•', '["æ£€éªŒå­¦ä¹ æ•ˆæœ", "æ¨¡æ‹Ÿè€ƒè¯•ç¯å¢ƒ"]');

-- 6.3 é¢˜ç›®åˆ—è¡¨-çŸ¥è¯†ç‚¹å…³è”
INSERT INTO question_list_point_relations (question_list_id, content_id, sequence_order, source_type, selection_reason) VALUES 
(1, 1, 1, 'knowledge-base', 'è½¯ä»¶å·¥ç¨‹åŸºç¡€æ¦‚å¿µ'),
(1, 2, 2, 'knowledge-base', 'ç”Ÿå‘½å‘¨æœŸç†è§£'),
(1, 3, 3, 'knowledge-base', 'éœ€æ±‚åˆ†æé‡ç‚¹'),
(1, 6, 4, 'knowledge-base', 'åŸåˆ™ç†è§£æµ‹è¯•'),

(2, 4, 1, 'knowledge-area', 'æ•°ç»„åŸºç¡€'),
(2, 5, 2, 'knowledge-area', 'æ ˆæ¦‚å¿µ'),
(2, 8, 3, 'knowledge-area', 'æ ‘éå†'),

(3, 1, 1, 'custom', 'ç»¼åˆæµ‹è¯•-æ¦‚å¿µ'),
(3, 2, 2, 'custom', 'ç»¼åˆæµ‹è¯•-è¿‡ç¨‹'),
(3, 4, 3, 'custom', 'ç»¼åˆæµ‹è¯•-æ•°æ®ç»“æ„'),
(3, 6, 4, 'custom', 'ç»¼åˆæµ‹è¯•-åŸåˆ™'),
(3, 7, 5, 'custom', 'ç»¼åˆæµ‹è¯•-æ¨¡å‹'),
(3, 8, 6, 'custom', 'ç»¼åˆæµ‹è¯•-ç®—æ³•');

-- ====================================================================
-- 7. å¤ä¹ é˜Ÿåˆ—æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 7.1 ç”Ÿæˆå½“å‰å¤ä¹ é˜Ÿåˆ—
INSERT INTO user_review_queues (user_id, content_id, queue_type, priority, scheduled_at, estimated_duration) VALUES 
(3, 2, 'due', 4, '2025-01-08 09:00:00', 120),
(3, 5, 'due', 3, '2025-01-08 09:30:00', 90),
(3, 3, 'new', 2, '2025-01-08 10:00:00', 100),

(4, 3, 'due', 3, '2025-01-08 10:00:00', 85),
(4, 7, 'new', 2, '2025-01-08 10:30:00', 85);

-- 7.2 å¤ä¹ é˜Ÿåˆ—å…ƒæ•°æ®
INSERT INTO review_queue_metadata (user_id, queue_date, total_items, completed_items, due_items, new_items, review_goal, estimated_total_time) VALUES 
('3', '2025-01-08', 3, 0, 2, 1, 20, 52),
('4', '2025-01-08', 2, 0, 1, 1, 25, 28);

-- ====================================================================
-- 8. è®¢é˜…å…³ç³»æ¨¡å—ç§å­æ•°æ®
-- ====================================================================

-- 8.1 ç”¨æˆ·çŸ¥è¯†åº“è®¢é˜…
INSERT INTO user_knowledge_base_subscriptions (user_id, knowledge_base_id, role, subscription_type, subscribed_at, last_accessed_at, access_count) VALUES 
(3, 1, 'viewer', 'free', '2024-11-15 10:00:00', '2024-12-20 15:30:00', 45),
(3, 2, 'viewer', 'free', '2024-11-20 11:00:00', '2024-12-18 14:00:00', 32),
(4, 1, 'viewer', 'premium', '2024-11-10 09:00:00', '2024-12-19 16:45:00', 58),
(4, 2, 'viewer', 'premium', '2024-11-12 10:30:00', '2024-12-15 13:20:00', 41),
(4, 4, 'contributor', 'premium', '2024-11-25 14:00:00', '2024-12-17 11:15:00', 28),
(3, 4, 'viewer', 'free', '2024-12-01 16:00:00', '2024-12-10 12:30:00', 15);

-- 8.2 è®¢é˜…è®¾ç½®
INSERT INTO subscription_settings (subscription_id, personal_name, personal_color, sort_order, notification_enabled, sync_frequency) VALUES 
(1, 'è½¯å·¥åŸºç¡€', '#2196F3', 1, TRUE, 'daily'),
(2, 'æ•°æ®ç»“æ„', '#4CAF50', 2, TRUE, 'daily'),
(3, NULL, '#2196F3', 1, TRUE, 'realtime'),
(4, NULL, '#4CAF50', 2, TRUE, 'realtime'),
(5, 'é¢å‘å¯¹è±¡', '#795548', 3, FALSE, 'weekly'),
(6, 'OOPè¯¾ç¨‹', '#795548', 3, TRUE, 'daily');

-- ====================================================================
-- 9. ç³»ç»Ÿé…ç½®æ•°æ®æ›´æ–°
-- ====================================================================

-- æ›´æ–°ç³»ç»Ÿé…ç½®
UPDATE system_configs SET config_value = '2025-01-08' WHERE config_key = 'system.last_seed_date';
INSERT INTO system_configs (config_key, config_value, config_type, description, is_public) VALUES
('system.last_seed_date', '2025-01-08', 'string', 'æœ€åç§å­æ•°æ®æ›´æ–°æ—¥æœŸ', FALSE),
('demo.enabled', 'true', 'boolean', 'æ˜¯å¦å¯ç”¨æ¼”ç¤ºæ¨¡å¼', TRUE),
('demo.users', '["demo_teacher", "demo_student1", "demo_student2"]', 'json', 'æ¼”ç¤ºç”¨æˆ·åˆ—è¡¨', FALSE),
('system.official_knowledge_bases', '[1, 2, 3]', 'json', 'å®˜æ–¹çŸ¥è¯†åº“IDåˆ—è¡¨', FALSE),
('review.queue_generation_time', '08:00:00', 'string', 'å¤ä¹ é˜Ÿåˆ—ç”Ÿæˆæ—¶é—´', TRUE);

-- ====================================================================
-- 10. ç»Ÿè®¡æ•°æ®æ›´æ–°
-- ====================================================================

-- æ›´æ–°çŸ¥è¯†åº“ç»Ÿè®¡æ•°æ®
UPDATE knowledge_bases kb 
SET content_count = (
    SELECT COUNT(*) 
    FROM knowledge_base_content_relations kbcr 
    WHERE kbcr.knowledge_base_id = kb.id
),
subscriber_count = (
    SELECT COUNT(*) 
    FROM user_knowledge_base_subscriptions ukbs 
    WHERE ukbs.knowledge_base_id = kb.id AND ukbs.is_active = TRUE
);

-- æ›´æ–°çŸ¥è¯†ç‚¹ä½¿ç”¨æ¬¡æ•°
UPDATE knowledge_point_contents kpc 
SET usage_count = (
    SELECT COUNT(*) 
    FROM user_knowledge_point_states ukps 
    WHERE ukps.content_id = kpc.id
);

-- æ›´æ–°é¢˜ç›®åˆ—è¡¨å®é™…æ•°é‡
UPDATE custom_question_lists cql 
SET total_count = (
    SELECT COUNT(*) 
    FROM question_list_point_relations qlpr 
    WHERE qlpr.question_list_id = cql.id AND qlpr.is_active = TRUE
);

-- ====================================================================
-- 11. åˆ›å»ºæ¼”ç¤ºç”¨è§¦å‘å™¨æµ‹è¯•æ•°æ®
-- ====================================================================

-- æµ‹è¯•è§¦å‘å™¨ï¼šæ·»åŠ æ–°çš„çŸ¥è¯†åº“å†…å®¹å…³è”
INSERT INTO knowledge_base_content_relations (knowledge_base_id, content_id, category, added_by) VALUES 
(3, 1, 'ç½‘ç»œåŸºç¡€', 5);

-- æµ‹è¯•è§¦å‘å™¨ï¼šæ–°ç”¨æˆ·è®¢é˜…çŸ¥è¯†åº“
INSERT INTO user_knowledge_base_subscriptions (user_id, knowledge_base_id, role) VALUES 
(3, 3, 'viewer');

-- æ¢å¤å¤–é”®æ£€æŸ¥
SET FOREIGN_KEY_CHECKS = 1;

-- ====================================================================
-- ç§å­æ•°æ®æ’å…¥å®Œæˆ
-- ====================================================================

-- è¾“å‡ºç»Ÿè®¡ä¿¡æ¯
SELECT 
    'ç§å­æ•°æ®æ’å…¥å®Œæˆ' as status,
    (SELECT COUNT(*) FROM users) as total_users,
    (SELECT COUNT(*) FROM knowledge_bases) as total_knowledge_bases,
    (SELECT COUNT(*) FROM knowledge_point_contents) as total_contents,
    (SELECT COUNT(*) FROM user_knowledge_point_states) as total_user_states,
    (SELECT COUNT(*) FROM custom_question_lists) as total_question_lists,
    (SELECT COUNT(*) FROM user_knowledge_base_subscriptions) as total_subscriptions; 